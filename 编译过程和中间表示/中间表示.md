中间表示

中间表示是太极语言的核心一环，理解太极语言的中间表示将对理解太极语言整体概念、语法及解析和具体使用，都会有很大的帮助。因此，在具体讨论编译过程的其它内容之前，让我们先来看一看太极语言解析、编译、求解过程中都将涉及到的中间表示。我们也可以把这一中间表示看作一个语言，因此也可以将中间表示称之为中间语言。将这种形式的程序或代码称为中间代码，有时候也叫做中间程序。
太极语言采用[json](http://www.json.org/)作为自己的中间表示。json除了原子以外，包括数组（也叫列表）和对象两种结构化数据。作为lisp风格的语言，理论上我们完全可以选择只使用数组这一种结构化容器。但是出于实用性的目的以及实现方面和重构的原因，也使用了对象。

下面介绍源代码和目标代码中的各种构造在中间表示中的形式：

变量或符号：以字符串或json对象。如果是字符串，不应该被封包在""之中。

字符串: 太极语言源代码中的字符串（将被转换成目标代码的字符串）以字符原因串表示。该字符串必须被封闭在""之中，也就是说，这个字符的的第一个和最后一个字符都是`"`。

数组：中间表示的空数组最终为被转换为目标代码的空数组。否则，该数组表示一个表达式。数组的第一项是该表达式的命令，它可以是个变量、符号或者数组。

数字：源代码的数字在中间表示表示为数字或者json对象。

为了提供错误的源码信息，包括开始和结束行号，列号，文本位置等，字符串，数字，变量或符号有可能被封包在json对象中。数组则有可能附带这些信息。

当前的中间表示在实现上不够优化。第一个问题是附加源码信息的方法不一致，第二个问题是变量、符号、字符串有可能是字符串形式，也可能是json对象形式。这些不一致导致在编译过程中经常需要利用一个函数取得项目的实际值。这不必要地复杂化了编译过程。这个函数调用的频率非常高，降低了编译速度，对编译速度会有所影响。将来可能会采用更为一致，有利于简化编译算法和提高编译速度的实现。