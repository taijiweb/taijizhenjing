## 元编译概述

太极语言实现了非常丰富而通用的元编译特征。每一个太极语言程序都可以包含两类代码。一类代码被称为编译时间代码，也称为元级代码，元代码。这些代码里面的语句、表达式分别被称为元语句、元表达式。另一类代码被称为运行时间代码，也称为目标代码。也可以理解为程序中的这两类代码处于两个层级：元级和目标级。元级是更高层次的一级，它处理和产生目标级的代码。我们可以通过一些算符或语句指定哪些代码是元代码，控制用元代码生成目标代码的方法等。这些算符称为元算符，语句称为元语句。依据这两类代码，太极语言的编译过程可以分为两个步骤：元编译阶段和目标代码编译阶段。元编译阶段先生成一个元编译程序，目标代码将作为元编译程序处理的数据，或者是它的参数。随后，系统将执行这个元编译程序，产生一个中间表示，这个中间表示经过一系列的编译阶段，产生最终的目标程序。

这就象是[M. C. Escher](http://en.wikipedia.org/wiki/M._C._Escher)的画作：[自己画出自己的手](http://en.wikipedia.org/wiki/M._C._Escher#mediaviewer/File:DrawingHands.jpg)，听起来似乎有些不可思议。然而，太极语言确实做到了这一点。

宏在太极语言中，成为元编译的一个重要的特例。

因为太极语言有如此强大而又独特的元编译功能，因此，我们在描述它的编译过程和相关内容时，引入了很多新的名词，对于原来的概念也引进了一些新的术语。我们还对同一个实体采用了不同的名字。这样做，我们可以从不同的角度来解释这个全新的事物，帮助我们加深理解。也让一个概念在不同的上下文中显得更加清晰，避免混淆。

从下面的示例程序可以更清楚地解释上面的内容。

```
taiji language 0.1

a #= 1

b #/= 2

c = 3

# if a==1 then 
  print b
else print c

array? #= (obj) -> ` (Object::toString.call(^obj) == '[object Array]')

array? # []

```

上述例子中，
* `a #= 1` 是元赋值语句，它表示元代码`a = 1`
* `b #/= 2`，是跨元赋值语句，它表示元代码和目标代码同时有`a = 1`
* `c = 3`是普通的目标级代码
* `# if ...`是预处理if语句，根据条件`a==1`(这个条件在元级执行), 目标代码中应该为`print b`。
* `array? #= ...` 在元级定义了函数array?
* `array? # []`是宏调用，将在目标代码产生`(Object::toString.call([]) == '[object Array]'`

太极语言提供了丰富的元算符和元语句。下一节将介绍这些算符和语句。